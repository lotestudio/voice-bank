import{P as h,c as w}from"./index-DT0_wXCD.js";import{d,g as _,f as i,w as c,C as f,b as o,o as p,Q as S,j as R,m as q,z as B,Y as E,E as $,B as I,ag as M,ah as z,q as F,D as L}from"./app-n_fLUIe1.js";import{a as y,i as b}from"./useForwardExpose-D7BoLfg_.js";import{c as x}from"./index-OGXtXS_A.js";const[k,j]=x("AvatarRoot");var P=d({__name:"AvatarRoot",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(a){return y(),j({imageLoadingStatus:_("idle")}),(e,s)=>(p(),i(o(h),{"as-child":e.asChild,as:e.as},{default:c(()=>[f(e.$slots,"default")]),_:3},8,["as-child","as"]))}}),D=P,N=d({__name:"AvatarFallback",props:{delayMs:{type:Number,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(a){const e=a,s=k();y();const l=_(e.delayMs===void 0);return S(r=>{if(e.delayMs&&b){const u=window.setTimeout(()=>{l.value=!0},e.delayMs);r(()=>{window.clearTimeout(u)})}}),(r,u)=>l.value&&o(s).imageLoadingStatus.value!=="loaded"?(p(),i(o(h),{key:0,"as-child":r.asChild,as:r.as},{default:c(()=>[f(r.$slots,"default")]),_:3},8,["as-child","as"])):R("v-if",!0)}}),T=N;function A(a,e){return a?e?(a.src!==e&&(a.src=e),a.complete&&a.naturalWidth>0?"loaded":"loading"):"error":"idle"}function Q(a,{referrerPolicy:e,crossOrigin:s}={}){const l=_(!1),r=_(null),u=q(()=>l.value?(!r.value&&b&&(r.value=new window.Image),r.value):null),v=_(A(u.value,a.value)),m=n=>()=>{l.value&&(v.value=n)};return B(()=>{l.value=!0,S(n=>{const t=u.value;if(!t)return;v.value=A(t,a.value);const g=m("loaded"),C=m("error");t.addEventListener("load",g),t.addEventListener("error",C),e!=null&&e.value&&(t.referrerPolicy=e.value),typeof(s==null?void 0:s.value)=="string"&&(t.crossOrigin=s.value),n(()=>{t.removeEventListener("load",g),t.removeEventListener("error",C)})})}),E(()=>{l.value=!1}),v}var U=d({__name:"AvatarImage",props:{src:{type:String,required:!0},referrerPolicy:{type:null,required:!1},crossOrigin:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"img"}},emits:["loadingStatusChange"],setup(a,{emit:e}){const s=a,l=e,{src:r,referrerPolicy:u,crossOrigin:v}=$(s);y();const m=k(),n=Q(r,{referrerPolicy:u,crossOrigin:v});return I(n,t=>{l("loadingStatusChange",t),t!=="idle"&&(m.imageLoadingStatus.value=t)},{immediate:!0}),(t,g)=>M((p(),i(o(h),{role:"img","as-child":t.asChild,as:t.as,src:o(r),"referrer-policy":o(u)},{default:c(()=>[f(t.$slots,"default")]),_:3},8,["as-child","as","src","referrer-policy"])),[[z,o(n)==="loaded"]])}}),W=U;const K=d({__name:"Avatar",props:{class:{}},setup(a){const e=a;return(s,l)=>(p(),i(o(D),{"data-slot":"avatar",class:F(o(w)("relative flex size-8 shrink-0 overflow-hidden rounded-full",e.class))},{default:c(()=>[f(s.$slots,"default")]),_:3},8,["class"]))}}),X=d({__name:"AvatarFallback",props:{delayMs:{},asChild:{type:Boolean},as:{},class:{}},setup(a){const e=a,s=q(()=>{const{class:l,...r}=e;return r});return(l,r)=>(p(),i(o(T),L({"data-slot":"avatar-fallback"},s.value,{class:o(w)("bg-muted dark:bg-primary flex size-full items-center justify-center rounded-full",e.class)}),{default:c(()=>[f(l.$slots,"default")]),_:3},16,["class"]))}}),Z=d({__name:"AvatarImage",props:{src:{},referrerPolicy:{},crossOrigin:{},asChild:{type:Boolean},as:{}},setup(a){const e=a;return(s,l)=>(p(),i(o(W),L({"data-slot":"avatar-image"},e,{class:"aspect-square size-full"}),{default:c(()=>[f(s.$slots,"default")]),_:3},16))}});export{X as _,K as a,Z as b};
