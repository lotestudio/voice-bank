import{d as E,E as ee,g as S,B as te,f as q,w as C,C as k,b as e,o,D as ae,I as se,J as le,m as Y,z as oe,c as p,a as R,F,H as W,e as B,j as g,q as $,N as J,s as G,O as re,t as N,l as X,k as fe,M as ne,A as me}from"./app-n_fLUIe1.js";import{u as ve}from"./useToggle-BLjUT96N.js";import{_ as ge}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as ye,M as he,F as _e,G as be,H as Ce,I as ke,J as xe}from"./index-CyCFDcJn.js";import{c as ue}from"./createLucideIcon-DJijaLzS.js";import{u as we,a as Pe,b as Te,c as Se,d as Be,e as Me,f as ie,g as qe}from"./useAjax-XmtRkf0g.js";import{c as $e}from"./index-OGXtXS_A.js";import{a as H}from"./useForwardExpose-D7BoLfg_.js";import{b as Ae,l as De}from"./DialogTitle-C2oEofh3.js";import{P as Le}from"./index-DT0_wXCD.js";import{d as Ne}from"./index-CIgP3Fza.js";const[de,Re]=$e("ContextMenuRoot");var Ee=E({inheritAttrs:!1,__name:"ContextMenuRoot",props:{pressOpenDelay:{type:Number,required:!1,default:700},dir:{type:String,required:!1},modal:{type:Boolean,required:!1,default:!0}},emits:["update:open"],setup(t,{emit:l}){const s=t,r=l,{dir:u,modal:a,pressOpenDelay:n}=ee(s);H();const f=ye(u),d=S(!1),m=S();return Re({open:d,onOpenChange:c=>{d.value=c},dir:f,modal:a,triggerElement:m,pressOpenDelay:n}),te(d,c=>{r("update:open",c)}),(c,P)=>(o(),q(e(he),{open:d.value,"onUpdate:open":P[0]||(P[0]=A=>d.value=A),dir:e(f),modal:e(a)},{default:C(()=>[k(c.$slots,"default")]),_:3},8,["open","dir","modal"]))}}),Ie=Ee,Oe=E({__name:"ContextMenuContent",props:{forceMount:{type:Boolean,required:!1},loop:{type:Boolean,required:!1},sideFlip:{type:Boolean,required:!1},alignOffset:{type:Number,required:!1,default:0},alignFlip:{type:Boolean,required:!1},avoidCollisions:{type:Boolean,required:!1,default:!0},collisionBoundary:{type:null,required:!1,default:()=>[]},collisionPadding:{type:[Number,Object],required:!1,default:0},sticky:{type:String,required:!1,default:"partial"},hideWhenDetached:{type:Boolean,required:!1,default:!1},positionStrategy:{type:String,required:!1},disableUpdateOnLayoutShift:{type:Boolean,required:!1},prioritizePosition:{type:Boolean,required:!1},reference:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","closeAutoFocus"],setup(t,{emit:l}){const u=Ae(t,l);H();const a=de(),n=S(!1);return(f,d)=>(o(),q(e(_e),ae(e(u),{side:"right","side-offset":2,align:"start","update-position-strategy":"always",style:{"--reka-context-menu-content-transform-origin":"var(--reka-popper-transform-origin)","--reka-context-menu-content-available-width":"var(--reka-popper-available-width)","--reka-context-menu-content-available-height":"var(--reka-popper-available-height)","--reka-context-menu-trigger-width":"var(--reka-popper-anchor-width)","--reka-context-menu-trigger-height":"var(--reka-popper-anchor-height)"},onCloseAutoFocus:d[0]||(d[0]=m=>{!m.defaultPrevented&&n.value&&m.preventDefault(),n.value=!1}),onInteractOutside:d[1]||(d[1]=m=>{m.detail.originalEvent.button===2&&m.target===e(a).triggerElement.value&&m.preventDefault(),!m.defaultPrevented&&!e(a).modal.value&&(n.value=!0)})}),{default:C(()=>[k(f.$slots,"default")]),_:3},16))}}),Fe=Oe,Ve=E({__name:"ContextMenuItem",props:{disabled:{type:Boolean,required:!1},textValue:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["select"],setup(t,{emit:l}){const s=t,u=De(l);return H(),(a,n)=>(o(),q(e(be),se(le({...s,...e(u)})),{default:C(()=>[k(a.$slots,"default")]),_:3},16))}}),je=Ve,He=E({__name:"ContextMenuPortal",props:{to:{type:null,required:!1},disabled:{type:Boolean,required:!1},defer:{type:Boolean,required:!1},forceMount:{type:Boolean,required:!1}},setup(t){const l=t;return(s,r)=>(o(),q(e(Ce),se(le(l)),{default:C(()=>[k(s.$slots,"default")]),_:3},16))}}),ze=He;function Z(t){return t.pointerType!=="mouse"}var Ue=E({inheritAttrs:!1,__name:"ContextMenuTrigger",props:{disabled:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(t){const l=t,{disabled:s}=ee(l),{forwardRef:r,currentElement:u}=H(),a=de(),n=S({x:0,y:0}),f=Y(()=>({getBoundingClientRect:()=>({width:0,height:0,left:n.value.x,right:n.value.x,top:n.value.y,bottom:n.value.y,...n.value})})),d=S(0);function m(){window.clearTimeout(d.value)}function c(i){n.value={x:i.clientX,y:i.clientY},a.onOpenChange(!0)}async function P(i){s.value||(await W(),i.defaultPrevented||(m(),c(i),i.preventDefault()))}async function A(i){s.value||(await W(),Z(i)&&!i.defaultPrevented&&(m(),d.value=window.setTimeout(()=>c(i),a.pressOpenDelay.value)))}async function T(i){s.value||(await W(),Z(i)&&!i.defaultPrevented&&m())}return oe(()=>{u.value&&(a.triggerElement.value=u.value)}),(i,I)=>(o(),p(F,null,[R(e(ke),{as:"template",reference:f.value},null,8,["reference"]),R(e(Le),ae({ref:e(r),as:i.as,"as-child":i.asChild,"data-state":e(a).open.value?"open":"closed","data-disabled":e(s)?"":void 0,style:{WebkitTouchCallout:"none",pointerEvents:"auto"}},i.$attrs,{onContextmenu:P,onPointerdown:A,onPointermove:T,onPointercancel:T,onPointerup:T}),{default:C(()=>[k(i.$slots,"default")]),_:3},16,["as","as-child","data-state","data-disabled"])],64))}}),We=Ue;/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=ue("ChevronDownIcon",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=ue("ChevronUpIcon",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);function Je(t){return{setSortBy:s=>{delete t.value.urlParams.page,t.value.urlParams.s===s?t.value.urlParams.o=t.value.urlParams.o==="asc"?"desc":"asc":(t.value.urlParams.s=s,t.value.urlParams.o="asc")}}}const Ge=["name","value"],Ke={__name:"LoteToggle",props:{defaultState:{type:Boolean,default:!0},url:{type:String,default:""},name:{type:String,default:""},ajaxData:{type:Object,default:()=>({})},method:{type:String,default:"post"},dont_watch_ajax_data:{type:Boolean,default:!1},rotate:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["input","change","update"],setup(t,{emit:l}){const s=t,r=l,{state:u,loading:a,toggle:n,getActiveClasses:f,getInactiveClasses:d}=ve(s,r);return(m,c)=>(o(),p("div",null,[B("div",{onClick:c[0]||(c[0]=P=>e(n)()),class:"toggle"},[B("div",{class:$(e(f))},[k(m.$slots,"active",{loading:e(a)},void 0,!0)],2),B("div",{class:$(e(d))},[k(m.$slots,"inactive",{loading:e(a)},void 0,!0)],2),t.url===""&&t.name!==""?(o(),p("input",{key:0,type:"hidden",name:t.name,value:e(u)},null,8,Ge)):g("",!0)])]))}},Qe=ge(Ke,[["__scopeId","data-v-88883d89"]]),Ze={class:"text-left"},et={key:0,class:"tooltip"},tt={key:0,class:"tooltip"},at=["onClick"],st={key:0,class:"tooltip"},lt={__name:"dtHeader",setup(t){const l=J("state"),{setSortBy:s}=Je(l);return(r,u)=>(o(),p("thead",Ze,[B("tr",null,[(o(!0),p(F,null,G(e(l).columns,(a,n)=>(o(),p(F,{key:n},[e(l).columnsVisibility[n]??!0?(o(),p("th",{key:0,class:$(["font-light p-2 hover:bg-black-100",a.classes]),style:re(a.style??"")},[a.selectable?(o(),p("div",{key:0,class:$(a.tooltip?"has-tooltip":"")},[R(Qe,{defaultState:!1,onInput:u[0]||(u[0]=f=>r.$emit("select",f))},{active:C(()=>[...u[1]||(u[1]=[B("span",{class:"cursor-pointer text-xl i-checkCircle"},null,-1)])]),inactive:C(()=>[...u[2]||(u[2]=[B("span",{class:"cursor-pointer text-xl i-circle"},null,-1)])]),_:1}),a.tooltip?(o(),p("span",et,N(a.tooltip),1)):g("",!0)],2)):a.sort?(o(),p("div",{key:2,class:$(["cursor-pointer",a.tooltip?"has-tooltip":""]),onClick:fe(f=>e(s)(a.sort),["stop","prevent"])},[B("span",null,[X(N(a.label)+" ",1),a.tooltip?(o(),p("span",st,N(a.tooltip),1)):g("",!0)]),e(l).urlParams.s!==a.sort?(o(),q(e(xe),{key:0,size:"16",class:"inline-block"})):g("",!0),e(l).urlParams.s===a.sort&&e(l).urlParams.o==="desc"?(o(),q(e(Xe),{key:1,size:"16",class:"inline-block"})):g("",!0),e(l).urlParams.s===a.sort&&e(l).urlParams.o==="asc"?(o(),q(e(Ye),{key:2,size:"16",class:"inline-block"})):g("",!0)],10,at)):(o(),p("span",{key:1,class:$(a.tooltip?"has-tooltip":"")},[X(N(a.label)+" ",1),a.tooltip?(o(),p("span",tt,N(a.tooltip),1)):g("",!0)],2))],6)):g("",!0)],64))),128))])]))}},ot={__name:"dtRow",props:{trClass:{type:String,default:""},index:{type:Number},show:{type:Boolean,default:!0},row:{type:Object,required:!0}},setup(t){return ne("row",t.row),(s,r)=>t.show?(o(),p("tr",{key:0,class:$(["hover:bg-light-200 hover:text-body",t.trClass])},[k(s.$slots,"default")],2)):g("",!0)}};function rt(t,l=null){t.style.userSelect="none",t.style.cursor="move";let s=!1,r,u,a,n,f=function(c){c.button===0&&(s=!0,r=c.pageX-t.offsetLeft,u=c.pageY-t.offsetTop,a=t.scrollLeft,n=t.scrollTop)},d=function(c){s=!1};t.addEventListener("mousemove",c=>{if(c.preventDefault(),!s)return;const P=c.pageX-t.offsetLeft,A=c.pageY-t.offsetTop;if(!l||l==="horizontal"){const T=P-r;t.scrollLeft=a-T}if(!l||l==="vertical"){const T=A-u;t.scrollTop=n-T}}),t.addEventListener("mousedown",f,!1),t.addEventListener("mouseup",d,!1),t.addEventListener("mouseleave",d,!1);const m=()=>{t.removeEventListener("mousedown",f),t.removeEventListener("mouseup",d),t.removeEventListener("mouseleave",d)};me(()=>{m()})}const nt=E({__name:"ContextMenu",props:{getActions:Function},setup(t){const l=t,s=S(),r=S(),u=S(),a=S([]),n=S([]),{copy:f}=Ne(),d=J("state"),m=()=>{f(s.value)},c=()=>{const y=d.value.columns.filter((D,O)=>d.value.columnsVisibility[O]).map(D=>D.label),x=u.value.split("	").map((D,O)=>(D=D.replace(/[\r\n]+/g," ").trim(),`${y[O]}: ${D}`)).join(`
`);f(x)},P=()=>{f(r.value)},A=()=>{r.value&&window.open(r.value,"_blank")},T=y=>{let v=y.target;for(a.value=[];v!==null;)v.tagName==="TR"&&(n.value=l.getActions(v.dataset.id),u.value=v.innerText,a.value.push("tr")),v.tagName==="TD"&&(s.value=v.innerText,a.value.push("td")),v.tagName==="TH"&&(s.value=v.innerText,a.value.push("th")),v.tagName==="A"&&(r.value=v.href,a.value.push("a")),v=v.parentNode},i=[{label:"Copy cell",callback:m,onTag:["td","th"]},{label:"Copy row",callback:c,onTag:["tr"]},{label:"Copy link address",callback:P,onTag:["a"]},{label:"Open link in new tab",callback:A,onTag:["a"]}],I=Y(()=>{const y=[];n.value.forEach(M=>{const x={label:M.label,callback:"openLink",href:M.href};y.push(x)});const v=i.filter(M=>M.onTag.some(x=>a.value.includes(x)));return[...y,...v]});function _(y,v){y.callback==="openLink"&&y.href&&(window.location.href=y.href),typeof y.callback=="function"&&y.callback(v)}const z=S(!1);return(y,v)=>(o(),q(e(Ie),null,{default:C(()=>[R(e(We),{"as-child":"",onContextmenu:T,disabled:z.value},{default:C(()=>[k(y.$slots,"default")]),_:3},8,["disabled"]),R(e(ze),null,{default:C(()=>[R(e(Fe),{class:"p-2 border flex flex-col gap-y-1 bg-background rounded text-sm z-40","side-offset":5},{default:C(()=>[(o(!0),p(F,null,G(I.value,M=>(o(),q(e(je),{key:M.label,as:"a",value:"New Tab",class:"cursor-pointer outline-none block hover:bg-accent p-2 rounded",onClick:x=>_(M,x)},{default:C(()=>[X(N(M.label),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:3}))}}),ut=["innerHTML"],it={key:2,class:"flex items-center justify-between"},dt={class:"flex items-center space-x-2"},ct={key:0},pt={class:"p-2"},ft={key:3,class:"w-full bg-red-100 z-10 p-4 rounded"},mt={key:0,class:"loteDataTable2"},Tt=E({__name:"DataTable2",props:{defaultUrl:{type:String,require:!0},offset:{type:Number,default:8},hasHiddenRow:{type:Boolean,default:!1},defaultUrlParams:{type:Array,default:()=>[]},selectable:{type:Boolean,default:!1},filtersContainerClasses:{type:String,default:"-mx-4"},dragScroll:{type:Boolean,default:!1}},setup(t,{expose:l}){const s=t,{state:r,resetState:u,hardReset:a,setDefaultUrlParams:n}=we(s.defaultUrl,s.defaultUrlParams),{filtersCount:f,setFilter:d,getFilter:m}=Pe(r),{toggleColumnVisibility:c,resetColumnVisibility:P}=ie(r),{toggleHiddenRow:A,selectedHiddenRowsIndexes:T}=Te(),{ajax:i,errorMessage:I,data:_,loading:z}=Se(r,P,s),{toggle:y,selectAll:v,deselectAll:M,selected:x}=Be(_,s.selectable),{setAction:D}=Me(r,i,s.defaultUrl);ne("state",r);const O=S(null),U=Y(()=>{if(_.value===null)return null;if(!s.hasHiddenRow)return _.value.data;const w=[];for(let b=0;b<_.value.data.length;b++)w.push(_.value.data[b]),w.push({hidden:!0,data:_.value.data[b]});return w});te(()=>r.value.urlParams,()=>{i()},{deep:!0});const ce=(w,b)=>{U.value[w].tr_class=b};oe(()=>{n(),i(),s.dragScroll&&rt(O.value,"vertical")});const pe=w=>{var b;return((b=U.value.find(V=>Number(V.id)===Number(w)))==null?void 0:b.actions)??[]};return l({refresh:i}),(w,b)=>{var V,K,Q;return o(),p("div",null,[w.$slots.filters?(o(),p("div",{key:0,class:$([t.filtersContainerClasses,"block md:flex md:items-center space-y-2 md:space-y-0 md:space-x-2 p-2 bg-muted/50 rounded-xl my-4 mx-1"])},[k(w.$slots,"filters",{columns:e(r).columns,urlParams:e(r).urlParams,setAction:e(D),setFilter:e(d),getFilter:e(m),resetFilters:e(u),hardReset:e(a),columnsVisibility:e(r).columnsVisibility,toggleColumnVisibility:e(c),resetColumnVisibility:e(P),total:(V=e(_))==null?void 0:V.total,filtersCount:e(f)})],2)):g("",!0),(K=e(_))!=null&&K.info?(o(),p("div",{key:1,innerHTML:(Q=e(_))==null?void 0:Q.info},null,8,ut)):g("",!0),t.selectable?(o(),p("div",it,[B("div",dt,[e(x).length>0?(o(),p("div",ct,[k(w.$slots,"selected_action",{selected:e(x),urlParams:e(r).urlParams})])):g("",!0)]),B("div",null,[B("div",pt,"Избрани: "+N(e(x).length),1)])])):g("",!0),e(I)?(o(),p("div",ft,N(e(I)),1)):g("",!0),B("div",{class:"loteDataTableWrapper",ref_key:"tableWrapper",ref:O},[R(nt,{getActions:pe},{default:C(()=>[e(_)!==null?(o(),p("table",mt,[R(lt,{onSelect:b[0]||(b[0]=h=>h?e(v)():e(M)())}),B("tbody",{class:$(["transition-opacity",{loading:e(z)}])},[(o(!0),p(F,null,G(U.value,(h,L)=>(o(),q(ot,{"tr-class":h.tr_class||"",key:h.id??L,"data-id":h.id??L,index:L,show:h.hidden?e(T).includes(L):!0,onClick:j=>e(y)(h.id),row:h},{default:C(()=>[h.hidden?g("",!0):k(w.$slots,"tr",{key:0,row:h,index:L,ajax:e(i),items:e(_),urlParams:e(r).urlParams,toggleHiddenRow:()=>e(A)(L),setTrClass:ce,isHiddenVisible:e(T).includes(L+1),isSelected:e(x).findIndex(j=>Number(j)===Number(h.id))>-1}),h.hidden?k(w.$slots,"tr-hidden",{key:1,row:h,index:L,isSelected:e(x).findIndex(j=>Number(j)===Number(h.id))>-1}):g("",!0)]),_:2},1032,["tr-class","data-id","index","show","onClick","row"]))),128))],2)])):g("",!0)]),_:3})],512),e(_)!==null&&e(I)===null?(o(),q(qe,{key:4,data:e(_),offset:t.offset,onChange:b[1]||(b[1]=h=>e(r).urlParams.page=h)},null,8,["data","offset"])):g("",!0)])}}}),St={__name:"dtTd",props:{column:[Number,String]},setup(t){const l=J("state"),{isColumnIndexVisible:s,isSortedColumn:r}=ie(l);return(u,a)=>{var n,f;return e(s)(t.column)?(o(),p("td",{key:0,class:$([{"bg-light-300":e(r)(t.column)},((n=e(l).columns[t.column])==null?void 0:n.tdClasses)??""]),style:re(((f=e(l).columns[t.column])==null?void 0:f.tdStyle)??"")},[k(u.$slots,"default")],6)):g("",!0)}}};export{Tt as _,St as a};
